!function($app){var patternFormat=function(e){return e?$(e).attr("format")||"DD/MM/YYYY":"DD/MM/YYYY"},parsePermission=function(e){var t={visible:{public:!0},enabled:{public:!0}};if(e)for(var r=e.toLowerCase().trim().split(","),a=0;a<r.length;a++){var i=r[a].trim();if(i){var n=i.split(":");if(2==n.length){var o=n[0].trim(),s=n[1].trim();if(s){for(var l=s.split(";"),c={},d=0;d<l.length;d++){var u=l[d].trim();u&&(c[u]=!0)}t[o]=c}}}}return t};app.directive("asDate",function(){return{require:"^ngModel",restrict:"A",link:function(e,t,r,a){function i(){var e=t.val(),r=moment(e,patternFormat(t));r.isValid()&&a.$setViewValue(r.toDate())}if(a){var n=patternFormat(t),o={format:n,locale:"pt-BR",showTodayButton:!0,useStrict:!0,tooltips:{today:"Hoje",clear:"Limpar seleção",close:"Fechar",selectMonth:"Selecionar mês",prevMonth:"Mês anterior",nextMonth:"Próximo mês",selectYear:"Selecionar ano",prevYear:"Ano anterior",nextYear:"Próximo ano",selectDecade:"Selecionar década",prevDecade:"Década anterior",nextDecade:"Próxima década",prevCentury:"Século anterior",nextCentury:"Próximo século"}};"DD/MM/YYYY"!=n&&(o.sideBySide=!0),t.datetimepicker(o),t.on("dp.change",function(){$(this).is(":visible")&&e.$apply(i)}),a.$render=function(){if(a.$viewValue){var e=moment(a.$viewValue);if(e.isValid())t.val(e.format(patternFormat(t)));else{var r=parseInt(a.$viewValue,10);e=moment(r),e.isValid()?t.val(e.format(patternFormat(t))):t.val("")}}else t.data("DateTimePicker").clear(),t.val("")},i()}}}}).directive("ngDestroy",function(){return{restrict:"A",link:function(scope,element,attrs,ctrl){element.on("$destroy",function(){attrs.ngDestroy&&attrs.ngDestroy.length>0&&(attrs.ngDestroy.indexOf("app.")>-1||attrs.ngDestroy.indexOf("blockly.")>-1?scope.$eval(attrs.ngDestroy):eval(attrs.ngDestroy))})}}}).directive("pwCheck",[function(){"use strict";return{require:"ngModel",link:function(e,t,r,a){var i="#"+r.pwCheck;t.add(i).on("keyup",function(){e.$apply(function(){var e=t.val()===$(i).val();a.$setValidity("pwmatch",e)})})}}}]).directive("valid",function(){return{require:"^ngModel",restrict:"A",link:function(e,t,r,a){var i={cpf:CPF,cnpj:CNPJ};a.$validators[r.valid]=function(e,a){var n=e||a,o=i[r.valid].isValid(n);return o?t[0].setCustomValidity(""):t[0].setCustomValidity(t[0].dataset.errorMessage),o||!n}}}}).directive("cronappSecurity",function(){return{restrict:"A",link:function(e,t,r){var a=[];e.session&&e.session.roles&&(a=e.session.roles.toLowerCase().split(","));for(var i=parsePermission(r.cronappSecurity),n=!1,o=!1,s=0;s<a.length;s++){var l=a[s].trim();l&&(i.visible[l]&&(n=!0),i.enabled[l]&&(o=!0))}n||$(t).hide(),o||$(t).find("*").addBack().attr("disabled",!0)}}})}(app);